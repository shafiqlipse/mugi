{% extends "dashboard/dashboard.html" %}

<!--static-->
{% block title %}Trainees{% endblock %}
<!--static-->
{% load static %}
<!--khfufufu-->
{% block content %}

<div class="content">
  <!-- Start Content-->
  <div class="container-fluid">
    <div class="py-3 d-flex align-items-sm-center flex-sm-row flex-column">
      <div class="flex-grow-1">
        <h4 class="fs-18 fw-semibold m-0">Trainees</h4>
      </div>

      <div class="text-end">
        <ol class="breadcrumb m-0 py-0">
          <li class="breadcrumb-item">
            <a href="javascript: void(0);">Pages</a>
          </li>
          <li class="breadcrumb-item active">Trainees</li>
        </ol>
      </div>
    </div>
    <!-- end page title -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <div class="card-tools">
              <div class="row">
                <div class="col-md-10">
                  <form method="get" class="form-control p-2">
                    <h2 class="card-title mb-0">Filter trainees</h2>
                    {% if user.is_superuser %}
              <h2 class="card-title mb-3">Total Collected: {{ total_collected }}</h2>{% endif %}
                    <div method="get" class="formlix flex">
                      <div method="get" class="row">
                        <div class="col-md-4">
                          <label for="gender">Gender</label>
                          {{ trainee_filter.form.gender }}
                        </div>

                        <div class="col-md-4">
                          <label for="school">Venue</label>
                          {{ trainee_filter.form.venue }}
                        </div>
                        <div class="col-md-4">
                          <label for="school">Course</label>
                          {{ trainee_filter.form.course }}
                        </div>
                        <div class="col-md-4">
                          <label for="school">Payment Status</label>
                          {{ trainee_filter.form.payment_status }}
                        </div>
                        <div class="col-md-4">
                          <label for="school">Date</label>
                          {{ trainee_filter.form.created_at }}
                        </div>
                        <div class="col-md-4"></div>
                      </div>
                      <button type="submit" class="btn btn-primary">
                        Apply Filter
                      </button>
                    </div>
                  </form>
                </div>
                <div class="col-md-2">
                  <h2 class="card-title mb-3">Reports</h2>
                  <form method="post" class="form-contol">
                    {% csrf_token %}
                    <input
                      type="submit"
                      name="Accreditation"
                      value="Accreditation"
                      class="btn btn-primary mb-2"
                      width="100%"
                    />
                  </form>
                  <form method="post" class="form-contol">
                    {% csrf_token %}
                    <input
                      type="submit"
                      name="Certificate"
                      value="Certificate"
                      class="btn btn-secondary mb-2"
                      width="100%"
                    />
                  </form>
                  <a href="{% url 'export_tcsv' %}" class="btn btn-success mb-2"
                    >Export CSV</a
                  >
                </div>
              </div>
            </div>
            <!-- end card header -->
          </div>
          <!-- end card header -->

          <div class="card-body table-responsive ">
            <table
              id="myaTable"
              class="table dt-responsivenowrap"
            >
              <thead>
                <tr>
                  <th>Names</th>
                  <th>Venue</th>
                  <th>Course</th>
                  <th>Phone Number</th>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for trainee in trainee_filter.qs %}
                <tr>
                  <td>
                    <a href="{% url 'trainee' trainee.id%}"
                      >{{trainee.first_name}} {{trainee.last_name}}</a
                    >
                  </td>

                  <td>{{trainee.venue}}</td>
                  <td>{{trainee.course}}</td>
                  <td>{{trainee.phone_number}}</td>
                  <td>{{trainee.created_at}}</td>
                  <td>{{trainee.payment_status}}</td>
                  <td>
                    <a
                      href="{% url 'update_trainee' trainee.id %}"
                      class="btn btn-warning"
                      >Edit</a
                    >
                    {% if trainee.payment_status == 'Completed' %}{% else %}
                    <a
                      href="{% url 'activate_trainee' trainee.id %}"
                      class="btn btn-success"
                      >Activate</a
                    >

                    <a
                      href="{% url 'delete_trainee' trainee.id %}"
                      class="btn btn-danger"
                      >Delete</a
                    >{% endif %}
                  </td>
                </tr>
                {%endfor%}
              </tbody>
            </table>
          </div>
          <!-- end card body -->
        </div>
        <!-- end card -->
      </div>
      <!-- end col -->
    </div>
    <!-- end row -->
  </div>
  <!-- container-fluid -->
</div>

{% endblock %}
<!-- content -->
