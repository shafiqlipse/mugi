{% extends "dashboard/dashboard.html" %}
<!---->
{% load static %}
<!--    hjjhh-->
{% block title %} Tickets{% endblock title %} {% block content %}
<div class="container content-wrapper">
  <div class="row">
    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title">Ticket Details</h4>
        </div>

        <div class="card-body">
          <ul class="list-group list-group-flush list-group-no-gutters">
            <li class="list-group-item px-0 pt-0">
              <div class="d-flex align-items-center gap-3">
                <div class="flex-shrink-0">
                  <div class="align-content-center text-center rounded-3">
                    <span
                      class="avatar rounded-3 avatar-sm bg-light d-flex align-items-center justify-content-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="23"
                        height="23"
                        viewBox="0 0 24 24"
                      >
                        <path
                          fill="#6c757d"
                          d="m3.7 11.287l3.623-3.624q.293-.292.671-.413t.783-.04l1.415.294Q9.073 8.873 8.366 9.98t-1.414 2.688zm4.125 1.62q.652-1.51 1.563-2.89q.91-1.378 2.08-2.548q1.873-1.873 4.073-2.806t4.746-.797q.136 2.546-.795 4.746t-2.803 4.073q-1.164 1.163-2.548 2.07t-2.897 1.559zm6.17-2.768q.44.44 1.066.44t1.066-.44t.44-1.057t-.44-1.057t-1.066-.44t-1.067.44t-.44 1.057t.44 1.056m-1.161 10.314L11.444 17.2q1.581-.706 2.691-1.423q1.111-.717 2.48-1.836l.289 1.415q.08.404-.031.785q-.111.382-.404.675zm-7.687-4.306q.587-.586 1.423-.58t1.423.594q.587.586.587 1.423t-.587 1.423q-.51.51-1.635.873t-2.605.502q.138-1.479.511-2.602t.883-1.633"
                        ></path>
                      </svg>
                    </span>
                  </div>
                </div>

                <div class="align-content-center">
                  <h6 class="mb-0 text-dark fs-14">School:</h6>
                </div>

                <div class="ms-auto align-content-center">
                  <span class="text-dark fw-medium fs-14 me-3"
                    >{{ticket.sender.school}}</span
                  >
                </div>
              </div>
            </li>
            <li class="list-group-item px-0 pt-0">
              <div class="d-flex align-items-center gap-3">
                <div class="flex-shrink-0">
                  <div class="align-content-center text-center rounded-3">
                    <span
                      class="avatar rounded-3 avatar-sm bg-light d-flex align-items-center justify-content-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="23"
                        height="23"
                        viewBox="0 0 24 24"
                      >
                        <path
                          fill="#6c757d"
                          d="m3.7 11.287l3.623-3.624q.293-.292.671-.413t.783-.04l1.415.294Q9.073 8.873 8.366 9.98t-1.414 2.688zm4.125 1.62q.652-1.51 1.563-2.89q.91-1.378 2.08-2.548q1.873-1.873 4.073-2.806t4.746-.797q.136 2.546-.795 4.746t-2.803 4.073q-1.164 1.163-2.548 2.07t-2.897 1.559zm6.17-2.768q.44.44 1.066.44t1.066-.44t.44-1.057t-.44-1.057t-1.066-.44t-1.067.44t-.44 1.057t.44 1.056m-1.161 10.314L11.444 17.2q1.581-.706 2.691-1.423q1.111-.717 2.48-1.836l.289 1.415q.08.404-.031.785q-.111.382-.404.675zm-7.687-4.306q.587-.586 1.423-.58t1.423.594q.587.586.587 1.423t-.587 1.423q-.51.51-1.635.873t-2.605.502q.138-1.479.511-2.602t.883-1.633"
                        ></path>
                      </svg>
                    </span>
                  </div>
                </div>

                <div class="align-content-center">
                  <h6 class="mb-0 text-dark fs-14">Topic:</h6>
                </div>

                <div class="ms-auto align-content-center">
                  <span class="text-dark fw-medium fs-14 me-3"
                    >{{ticket.topic}}</span
                  >
                </div>
              </div>
            </li>
            <li class="list-group-item px-0 pt-0">
              <div class="d-flex align-items-center gap-3">
                <div class="flex-shrink-0">
                  <div class="align-content-center text-center rounded-3">
                    <span
                      class="avatar rounded-3 avatar-sm bg-light d-flex align-items-center justify-content-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="23"
                        height="23"
                        viewBox="0 0 24 24"
                      >
                        <path
                          fill="#6c757d"
                          d="m3.7 11.287l3.623-3.624q.293-.292.671-.413t.783-.04l1.415.294Q9.073 8.873 8.366 9.98t-1.414 2.688zm4.125 1.62q.652-1.51 1.563-2.89q.91-1.378 2.08-2.548q1.873-1.873 4.073-2.806t4.746-.797q.136 2.546-.795 4.746t-2.803 4.073q-1.164 1.163-2.548 2.07t-2.897 1.559zm6.17-2.768q.44.44 1.066.44t1.066-.44t.44-1.057t-.44-1.057t-1.066-.44t-1.067.44t-.44 1.057t.44 1.056m-1.161 10.314L11.444 17.2q1.581-.706 2.691-1.423q1.111-.717 2.48-1.836l.289 1.415q.08.404-.031.785q-.111.382-.404.675zm-7.687-4.306q.587-.586 1.423-.58t1.423.594q.587.586.587 1.423t-.587 1.423q-.51.51-1.635.873t-2.605.502q.138-1.479.511-2.602t.883-1.633"
                        ></path>
                      </svg>
                    </span>
                  </div>
                </div>

                <div class="align-content-center">
                  <h6 class="mb-0 text-dark fs-14">Priority:</h6>
                </div>

                <div class="ms-auto align-content-center">
                  <span class="text-dark fw-medium fs-14 me-3"
                    >{{ticket.priority}}</span
                  >
                </div>
              </div>
            </li>
            <li class="list-group-item px-0 pt-0">
              <div class="d-flex align-items-center gap-3">
                <div class="flex-shrink-0">
                  <div class="align-content-center text-center rounded-3">
                    <span
                      class="avatar rounded-3 avatar-sm bg-light d-flex align-items-center justify-content-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="23"
                        height="23"
                        viewBox="0 0 24 24"
                      >
                        <path
                          fill="#6c757d"
                          d="m3.7 11.287l3.623-3.624q.293-.292.671-.413t.783-.04l1.415.294Q9.073 8.873 8.366 9.98t-1.414 2.688zm4.125 1.62q.652-1.51 1.563-2.89q.91-1.378 2.08-2.548q1.873-1.873 4.073-2.806t4.746-.797q.136 2.546-.795 4.746t-2.803 4.073q-1.164 1.163-2.548 2.07t-2.897 1.559zm6.17-2.768q.44.44 1.066.44t1.066-.44t.44-1.057t-.44-1.057t-1.066-.44t-1.067.44t-.44 1.057t.44 1.056m-1.161 10.314L11.444 17.2q1.581-.706 2.691-1.423q1.111-.717 2.48-1.836l.289 1.415q.08.404-.031.785q-.111.382-.404.675zm-7.687-4.306q.587-.586 1.423-.58t1.423.594q.587.586.587 1.423t-.587 1.423q-.51.51-1.635.873t-2.605.502q.138-1.479.511-2.602t.883-1.633"
                        ></path>
                      </svg>
                    </span>
                  </div>
                </div>

                <div class="align-content-center">
                  <h6 class="mb-0 text-dark fs-14">Status:</h6>
                </div>

                <div class="ms-auto align-content-center">
                  {% if ticket.status == 'Open' %}
                  <span class="badge text-bg-primary">{{ ticket.status }}</span
                  >{% elif ticket.status == 'Answered' %}
                  <span class="badge text-bg-secondary"
                    >{{ ticket.status }}</span
                  >
                  {% elif ticket.status == 'Picked up' %}
                  <span class="badge text-bg-warning">{{ ticket.status }}</span>
                  {% elif ticket.status == 'School Response' %}
                  <span class="badge text-bg-success">{{ ticket.status }}</span>
                  {% endif %}
                </div>
              </div>
            </li>
            <li class="list-group-item px-0 pt-0">
              <div class="d-flex align-items-center gap-3">
                <div class="flex-shrink-0">
                  <div class="align-content-center text-center rounded-3">
                    <span
                      class="avatar rounded-3 avatar-sm bg-light d-flex align-items-center justify-content-center"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="23"
                        height="23"
                        viewBox="0 0 24 24"
                      >
                        <path
                          fill="#6c757d"
                          d="m3.7 11.287l3.623-3.624q.293-.292.671-.413t.783-.04l1.415.294Q9.073 8.873 8.366 9.98t-1.414 2.688zm4.125 1.62q.652-1.51 1.563-2.89q.91-1.378 2.08-2.548q1.873-1.873 4.073-2.806t4.746-.797q.136 2.546-.795 4.746t-2.803 4.073q-1.164 1.163-2.548 2.07t-2.897 1.559zm6.17-2.768q.44.44 1.066.44t1.066-.44t.44-1.057t-.44-1.057t-1.066-.44t-1.067.44t-.44 1.057t.44 1.056m-1.161 10.314L11.444 17.2q1.581-.706 2.691-1.423q1.111-.717 2.48-1.836l.289 1.415q.08.404-.031.785q-.111.382-.404.675zm-7.687-4.306q.587-.586 1.423-.58t1.423.594q.587.586.587 1.423t-.587 1.423q-.51.51-1.635.873t-2.605.502q.138-1.479.511-2.602t.883-1.633"
                        ></path>
                      </svg>
                    </span>
                  </div>
                </div>

                <div class="align-content-center">
                  <h6 class="mb-0 text-dark fs-14">Date:</h6>
                </div>

                <div class="ms-auto align-content-center">
                  <span class="text-dark fw-medium fs-14 me-3"
                    >{{ticket.created_at}}</span
                  >
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title">{{ticket.title}}</h4>
          <p class="text-muted mb-0">{{ticket.content}}</p>
        </div>
        <div class="card-body">
          <div class="left-ticket">
            <div class="ticket-body">
              {% for response in responses %}
          <div
  {% if response.responder.is_staff %}
    class="alert alert-secondary"
  {% elif response.responder.is_school %}
    class="alert alert-primary"
  {% else %}
    class="alert alert-target"
  {% endif %}
  role="alert"
>
           
                <small class="badge text-bg-primary"
                  >{{response.responder.first_name}}</small
                >
                <p>{{response.message}}</p>
              </div>
              {% endfor %}
            </div>
            <div class="form-container">
              <div class="form-header">
                <h3 class="mb-0 card-title">Reply</h3>
              </div>
              <div class="form-body">
                <form
                  method="post"
                  class="p-3 bg-white border-t sticky bottom-0"
                >
                  {% csrf_token %}
                  <div class="form-group">
                    <textarea
                      class="form-control"
                      name="message"
                      id="message"
                      rows="3"
                    ></textarea>
                  </div>
                  <button type="submit" class="btn btn-primary mt-2">
                    Submit response
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}
